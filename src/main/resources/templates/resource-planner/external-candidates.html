<!-- FILE: templates/resource-planner/external-candidates.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${project.name} + ' - External Candidates'">External Candidates</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Use same styles as other pages, or copy from dashboard.html */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f1f5f9; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08); border-left: 5px solid #2196f3; }
        .card { background: white; border-radius: 10px; padding: 20px; margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05); }
        .btn { padding: 8px 16px; border-radius: 6px; text-decoration: none; font-size: 13px;
            display: inline-flex; align-items: center; gap: 6px; border: none; cursor: pointer; }
        .btn-primary { background: #2196f3; color: white; }
        .btn-secondary { background: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; }
        .candidate-card { border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
        .skill-tag { background: #e0f2fe; color: #0369a1; padding: 4px 10px; border-radius: 15px;
            font-size: 12px; display: inline-block; margin: 2px; }
        .source-badge { padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 500; }
        .linkedin { background: #0077b5; color: white; }
        .indeed { background: #2164f3; color: white; }
    </style>
</head>
<body>
<div class="container">
    <!-- Header -->
    <div class="header">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div>
                <h1 style="color: #1e293b; margin-bottom: 10px;">
                    <i class="fas fa-globe"></i>
                    External Candidates for: <span th:text="${project.name}">Project Name</span>
                </h1>
                <p style="color: #64748b;">
                    These candidates were found through external job boards and APIs
                </p>
            </div>
            <div>
                <a th:href="@{'/ui/resource-planner/project/' + ${project.id}}"
                   class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back to Project
                </a>
            </div>
        </div>
    </div>

    <!-- External Search Status -->
    <div class="card">
        <h3 style="color: #1e293b; margin-bottom: 15px;">
            <i class="fas fa-search"></i> External Search Status
        </h3>
        <div style="display: flex; gap: 20px; align-items: center;">
            <div th:if="${project.externalSearchNeeded}"
                 style="background: #e0f2fe; padding: 10px 15px; border-radius: 6px; flex: 1;">
                <div style="font-weight: 600; color: #0369a1;">
                    <i class="fas fa-sync-alt fa-spin"></i> Search in Progress
                </div>
                <div style="font-size: 13px; color: #64748b;">
                    Searching external platforms for matching candidates...
                </div>
            </div>
            <div th:if="${not project.externalSearchNeeded}"
                 style="background: #d1fae5; padding: 10px 15px; border-radius: 6px; flex: 1;">
                <div style="font-weight: 600; color: #065f46;">
                    <i class="fas fa-check-circle"></i> Search Complete
                </div>
                <div style="font-size: 13px; color: #64748b;">
                    Found <span th:text="${externalCandidates.size()}">0</span> candidates
                </div>
            </div>

            <form th:action="@{'/ui/resource-planner/project/' + ${project.id} + '/external-search'}"
                  method="post" th:if="${not project.externalSearchNeeded}">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-redo"></i> Refresh Search
                </button>
            </form>
        </div>
    </div>

    <!-- Candidate List -->
    <div class="card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="color: #1e293b;">
                <i class="fas fa-user-tie"></i>
                External Candidates (<span th:text="${externalCandidates.size()}">0</span>)
            </h3>
            <span style="color: #64748b; font-size: 14px;">
                <i class="fas fa-info-circle"></i> These are not yet in our employee database
            </span>
        </div>

        <!-- Candidate Cards -->
        <div th:if="${hasExternalCandidates}">
            <div th:each="candidate : ${externalCandidates}" class="candidate-card">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                    <div>
                        <h4 style="color: #1e293b; margin-bottom: 5px;" th:text="${candidate.name}">
                            External Candidate
                        </h4>
                        <div style="display: flex; gap: 15px; font-size: 13px; color: #64748b;">
                            <div>
                                <i class="fas fa-briefcase"></i>
                                <span th:text="${candidate.experience}">5 years</span> experience
                            </div>
                            <div>
                                <i class="fas fa-map-marker-alt"></i>
                                <span th:text="${candidate.containsKey('location') ? candidate.get('location') : 'Remote'}">Remote</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <span th:class="'source-badge ' + ${candidate.source == 'LinkedIn' ? 'linkedin' : 'indeed'}"
                              th:text="${candidate.source}">LinkedIn</span>
                    </div>
                </div>

                <!-- Skills -->
                <div style="margin-bottom: 15px;">
                    <div style="font-weight: 500; color: #475569; font-size: 13px; margin-bottom: 8px;">
                        Skills:
                    </div>
                    <div>
                        <span th:each="skill : ${candidate['skills'].split(', ')}"
                        class="skill-tag" th:text="${skill}">Java</span>
                    </div>
                </div>

                <!-- Actions -->
                <div style="display: flex; gap: 10px; border-top: 1px solid #e2e8f0; padding-top: 15px;">
                    <button class="btn btn-primary" style="flex: 1;">
                        <i class="fas fa-envelope"></i> Contact
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;">
                        <i class="fas fa-user-plus"></i> Add to Database
                    </button>
                    <button class="btn btn-secondary" style="flex: 1;">
                        <i class="fas fa-file-alt"></i> View Profile
                    </button>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div th:if="${not hasExternalCandidates}" style="text-align: center; padding: 40px 20px; color: #94a3b8;">
            <i class="fas fa-search" style="font-size: 48px; margin-bottom: 15px; opacity: 0.5;"></i>
            <h3 style="color: #475569; margin-bottom: 10px;">No External Candidates Found</h3>
            <p>Try searching with different criteria or refresh the search.</p>
            <form th:action="@{'/ui/resource-planner/project/' + ${project.id} + '/external-search'}"
                  method="post" style="margin-top: 20px;">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-redo"></i> Search Again
                </button>
            </form>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="card" th:if="${hasExternalCandidates}">
        <h3 style="color: #1e293b; margin-bottom: 15px;">
            <i class="fas fa-chart-bar"></i> External Hiring Insights
        </h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
            <div style="text-align: center; padding: 15px; background: #f0f9ff; border-radius: 8px;">
                <div style="font-size: 24px; font-weight: 700; color: #0369a1;">
                    <span th:text="${externalCandidates.size()}">5</span>
                </div>
                <div style="font-size: 13px; color: #64748b;">Candidates Found</div>
            </div>
            <div style="text-align: center; padding: 15px; background: #f0f9ff; border-radius: 8px;">
                <div style="font-size: 24px; font-weight: 700; color: #10b981;">
                    2-4 <span style="font-size: 14px; color: #64748b;">weeks</span>
                </div>
                <div style="font-size: 13px; color: #64748b;">Average Hiring Time</div>
            </div>
            <div style="text-align: center; padding: 15px; background: #f0f9ff; border-radius: 8px;">
                <div th:with="displayBudget=${project.budget != null ? project.budget / 10 : 5000}"
                     style="font-size: 24px; font-weight: 700; color: #8b5cf6;">
                    $<span th:text="${#numbers.formatInteger(displayBudget, 1, 'POINT')}">5.000</span>
                </div>
                <div style="font-size: 13px; color: #64748b;">Avg. Hiring Cost</div>
            </div>
            <div style="text-align: center; padding: 15px; background: #f0f9ff; border-radius: 8px;">
                <div style="font-size: 24px; font-weight: 700; color: #f59e0b;">85%</div>
                <div style="font-size: 13px; color: #64748b;">Retention Rate</div>
            </div>
        </div>
    </div>
</div>
</body>
</html>